**Create table**

	CREATE OR REPLACE TABLE LIBRARY_CARD_CATALOG.PUBLIC.NESTED_INGEST_JSON 
	(
	  "RAW_NESTED_BOOK" VARIANT
	);

**Query**

	SELECT RAW_NESTED_BOOK
	FROM NESTED_INGEST_JSON;
	
	SELECT RAW_NESTED_BOOK:year_published
	FROM NESTED_INGEST_JSON;

	SELECT RAW_NESTED_BOOK:authors
	FROM NESTED_INGEST_JSON;

**Lateral Flatten Query**

	SELECT value:first_name
	FROM NESTED_INGEST_JSON
	,LATERAL FLATTEN(input => RAW_NESTED_BOOK:authors);

**Table Flatten Query**

	SELECT value:first_name
	FROM NESTED_INGEST_JSON
	,table(flatten(RAW_NESTED_BOOK:authors));

**Cast Query**

	SELECT value:first_name::VARCHAR, value:last_name::VARCHAR
	FROM NESTED_INGEST_JSON
	,LATERAL FLATTEN(input => RAW_NESTED_BOOK:authors);

**Alias**

	SELECT value:first_name::VARCHAR AS FIRST_NM
	, value:last_name::VARCHAR AS LAST_NM
	FROM NESTED_INGEST_JSON
	,LATERAL FLATTEN(input => RAW_NESTED_BOOK:authors);

**One time query**

	create or replace view SOCIAL_MEDIA_FLOODGATES.PUBLIC.HASHTAGS_NORMALIZED as
	(SELECT RAW_STATUS:user:id AS USER_ID
	,RAW_STATUS:id AS TWEET_ID
	,value:text::VARCHAR AS HASHTAG_TEXT
	FROM TWEET_INGEST
	,LATERAL FLATTEN
	(input => RAW_STATUS:entities:hashtags)
	);